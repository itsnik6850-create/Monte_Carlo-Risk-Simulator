
1	Excel Input Handling (parseWorkbook)	Reads the uploaded Excel file using the open source SheetJS xlsx library, extracts Working Budget, Contract Budget, Iterations from the Settings sheet, and risk parameters (Name, Probability, Low, Mode, High, Distribution) from the Risks sheet. It converts the sheets to simple JavaScript arrays so the rest of the code can work with them easily.	SheetJS browser examples for XLSX.read and sheet_to_json show this pattern. stackoverflow

2	Random Sampling (randTriangular)	Generates random numbers following a triangular distribution, defined by a minimum, most likely (mode), and maximum value. This matches how many cost risk models describe uncertain costs. The function uses the inverse cumulative distribution function (CDF) method, splitting into a left and right side of the triangle based on a uniform random number u.	The inverse CDF formula for triangular distributions is documented in cost estimating papers like ICEAA’s “The simple math behind triangular distributions and correlations” and Monte Carlo tutorials. iceaaonline+2

3	Monte Carlo Engine (runMonteCarlo)	Runs the core simulation: for N iterations (usually 1000) it starts from the Working Budget and, for each risk, randomly decides if the risk “occurs” (Bernoulli trial with probability p). If it occurs, it draws a cost from the risk’s triangular distribution and adds it to the total. The code stores the final total and each risk’s contribution for every iteration so we can calculate statistics and tornado charts later.	This is a standard Monte Carlo approach where total cost in each iteration is the sum of deterministic base cost plus random draws of each input variable. The idea is the same as in many Monte Carlo examples using triangular inputs. iceaaonline+1

4	Summary Statistics (summaryStats)	Computes key output metrics similar to an @RISK Output Report: minimum, maximum, mean, variance, standard deviation, skewness, kurtosis, median, and a set of percentiles (P05, P10, P20, P50, P80, P95). It sorts the simulated totals and uses standard textbook formulas for statistics and a simple interpolation method to get percentiles.	Formulas for mean, variance, skewness, kurtosis, and percentiles are standard in probability/statistics. Sites that discuss triangular distribution properties also show these statistics explicitly. statology

5	Tornado Sensitivity (buildTornado)	Creates the tornado chart data that shows which risks drive the output the most. For each risk, it sorts all simulations by that risk’s contribution, takes the lowest 10% and highest 10% of simulations, and computes the average total cost in each tail. The difference between “high” and “low” averages is the bar length. Finally, it sorts risks by this bar length and returns the top drivers for plotting. This approximates the “change in output statistic” style of tornado plot used by risk tools.	The “low vs high tail conditional mean” approach is a common practical method to approximate sensitivity – it resembles how some commercial tools derive tornado drivers by comparing output conditional on low vs high values in each input. Conceptually, it is a non parametric sensitivity analysis based on conditional expectations.
6	Histogram chart (renderHistogram)	Builds a frequency histogram of total project cost using Chart.js. It divides the cost range into 30 equal width bins, counts how many simulations fall into each bin, and plots those counts as a bar chart. Axis labels are formatted in the selected currency.	The binning idea (divide range into equal intervals and count) is the classic definition of a histogram. Chart.js “bar chart” examples provide the implementation pattern for labels, datasets, and options. geeksforgeeks

7	S Curve (CDF) chart (renderCDF)	Creates the S curve or cumulative distribution function (CDF) of total cost. It sorts the totals, then for each point sets the y value to the cumulative probability (i+1)/N. The result is a rising curve from 0 to 1 that shows the probability of not exceeding a given cost level. The labels on the x axis are the cost values formatted with currency.	Building an empirical CDF by sorting simulated values and using index based cumulative probability is standard in Monte Carlo simulation: F(x_i)≈(i+1)/Nfor the sorted sample x_i.
8	Tornado chart rendering (renderTornadoChart)	Takes the tornado driver data from buildTornado, extracts the risk names and their impact values, and plots a horizontal bar chart with Chart.js. The largest bar appears at the top, visually matching the typical tornado diagram look where the most influential risk is on top.	Uses Chart.js “horizontal bar” configuration (via indexAxis: 'y') as shown in Chart.js docs and tutorials. geeksforgeeks

9	CSV export (not shown in full here)	The CSV export function writes summary metrics (iterations, budgets, statistics, overrun probability) to a comma separated file so you can open it in Excel. The raw CSV option writes every iteration’s total and each risk’s contribution so you can build custom analyses or cross check results.	CSV is a simple text format native to Excel. The pattern new Blob([...], 'text/csv') + URL.createObjectURL is widely used in browser examples for downloading data generated on the client side.
